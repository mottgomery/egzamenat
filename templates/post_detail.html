{% extends 'base.html' %}

{% block title %}
–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –æ –∑–∞–¥–∞—á–µ
{% endblock %}
{% block head %}
	<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

{% endblock %}
{% block content %}
<div class="content">
<h4><strong>–ù–æ–º–µ—Ä –±–∏–ª–µ—Ç–∞:</strong><a href="{{ url_for('posts', title=post.title) }}" class="tag"> {{ post.title }}</a></h4>

<h4><strong>–£—Ä–æ–≤–µ–Ω—å –∑–∞–¥–∞—á–∏: {{ post.level }}</strong></h4>

<h4><div class="tags"><strong>–¢–µ–º—ã:</strong> {% for tag in post.tags %} <a href="{{ url_for('posts', tags=tag.name) }}" class="tag">{{ tag.name }}</a> {% endfor %} </div></h4>

<img class="zad__img modal-trigger" src="data:image/png;base64,{{ zad_base64 }}" alt="–£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏">


<!-- –ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç" -->
<button class="btn-custom btn-primary-custom mt-3" id="toggleSolution">–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç</button>

<!-- –°–∫—Ä—ã—Ç—ã–π –±–ª–æ–∫ —Å —Ä–µ—à–µ–Ω–∏–µ–º -->
<div id="solutionContainer" style="display: none;">
<p></p>

    <img class="zad__img modal-trigger" src="data:image/png;base64,{{ resh1_base64 }}" alt="–ü–µ—Ä–≤—ã–π —Å–ø–æ—Å–æ–± —Ä–µ—à–µ–Ω–∏—è">

    {% if resh2_base64 %}
        <img class="zad__img modal-trigger" src="data:image/png;base64,{{ resh2_base64 }}" alt="–í—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–± —Ä–µ—à–µ–Ω–∏—è">
    {% endif %}
    {% if resh3_base64 %}
        <img class="zad__img modal-trigger" src="data:image/png;base64,{{ resh3_base64 }}" alt="–¢—Ä–µ—Ç–∏–π —Å–ø–æ—Å–æ–± —Ä–µ—à–µ–Ω–∏—è">
    {% endif %}
    {% if resh4_base64 %}
        <img class="zad__img modal-trigger" src="data:image/png;base64,{{ resh4_base64 }}" alt="–ß–µ—Ç–≤—ë—Ä—Ç—ã–π —Å–ø–æ—Å–æ–± —Ä–µ—à–µ–Ω–∏—è">
    {% endif %}
    {% if resh5_base64 %}
        <img class="zad__img modal-trigger" src="data:image/png;base64,{{ resh5_base64 }}" alt="–ü—è—Ç—ã–π —Å–ø–æ—Å–æ–± —Ä–µ—à–µ–Ω–∏—è">
    {% endif %}
</div>

<a href="{{ url_for('posts') }}" class="btn-custom btn-secondary-custom mt-3">–í–µ—Ä–Ω—É—Ç—å—Å—è –∫–æ –≤—Å–µ–º –∑–∞–¥–∞—á–∞–º</a>


<!-- –§–æ—Ä–º–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
{% if current_user.role == 'admin' or current_user.role == 'teacher'%}
<form id="deleteForm" action="{{ url_for('delete_post', id=post.id) }}" method="post">
    <button id="deleteButton" type="button" class="btn-custom btn-danger-custom mt-3">–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É</button>
</form>
{% endif %}

{% if current_user.role == 'admin'%}
<a href="{{ url_for('update_post_tags', post_id=post.id) }}" class="btn-custom btn-primary-custom mt-3">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–≥–∏</a>
{% endif %}

<!-- –ö–Ω–æ–ø–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏–π -->
{% if current_user.role == 'admin' or current_user.role == 'teacher' %}
<button class="btn-custom btn-warning mt-3" id="editSolutionsBtn">–ò–∑–º–µ–Ω–∏—Ç—å —Ä–µ—à–µ–Ω–∏—è</button>
{% endif %}



<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—à–µ–Ω–∏–π -->
<div class="modal fade" id="editSolutionsModal" tabindex="-1" aria-labelledby="editSolutionsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editSolutionsModalLabel">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
            </div>
            <div class="modal-body">
                <form id="editSolutionsForm" action="{{ url_for('update_solutions', post_id=post.id) }}" method="POST" enctype="multipart/form-data">
                    <!-- –ü–µ—Ä–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ -->
                    <div class="mb-3 d-flex align-items-center">
                        <label for="resh1" class="form-label me-2">–ü–µ—Ä–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ</label>
                        <input type="file" class="form-control me-2" id="resh1" name="resh1">
                    </div>

                    <!-- –í—Ç–æ—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ -->
                    <div class="mb-3 d-flex align-items-center">
                        <label for="resh2" class="form-label me-2">–í—Ç–æ—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ</label>
                        <input type="file" class="form-control me-2" id="resh2" name="resh2">
                        <a href="{{ url_for('delete_solution', post_id=post.id, solution_number=2) }}" class="btn btn-danger btn-sm">üóëÔ∏è</a>
                    </div>

                    <!-- –¢—Ä–µ—Ç—å–µ —Ä–µ—à–µ–Ω–∏–µ -->
                    <div class="mb-3 d-flex align-items-center">
                        <label for="resh3" class="form-label me-2">–¢—Ä–µ—Ç—å–µ —Ä–µ—à–µ–Ω–∏–µ</label>
                        <input type="file" class="form-control me-2" id="resh3" name="resh3">
                        <a href="{{ url_for('delete_solution', post_id=post.id, solution_number=3) }}" class="btn btn-danger btn-sm">üóëÔ∏è</a>
                    </div>

                    <div class="mb-3 d-flex align-items-center">
                        <label for="resh4" class="form-label me-2">–ß–µ—Ç–≤—ë—Ä—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ</label>
                        <input type="file" class="form-control me-2" id="resh4" name="resh3">
                        <a href="{{ url_for('delete_solution', post_id=post.id, solution_number=4) }}" class="btn btn-danger btn-sm">üóëÔ∏è</a>
                    </div>

                    <div class="mb-3 d-flex align-items-center">
                        <label for="resh5" class="form-label me-2">–ü—è—Ç–æ–µ —Ä–µ—à–µ–Ω–∏–µ</label>
                        <input type="file" class="form-control me-2" id="resh3" name="resh5">
                        <a href="{{ url_for('delete_solution', post_id=post.id, solution_number=5) }}" class="btn btn-danger btn-sm">üóëÔ∏è</a>
                    </div>

                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                </form>
            </div>
        </div>
    </div>
</div>





<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ñ–æ—Ç–æ -->
<div id="photoModal" class="modal" tabindex="-1">
  <div class="modal-dialog modal-fullscreen">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="–ó–∞–∫—Ä—ã—Ç—å"></button>
      </div>
      <div class="modal-body p-0 d-flex justify-content-center align-items-center">
        <img id="modalImage" src="" alt="" class="w-100 h-100 object-fit-contain">
      </div>
    </div>
  </div>
</div>
</div>
<script>
// –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º —Ñ–æ—Ç–æ
const modalTriggerElements = document.querySelectorAll('.modal-trigger');
const photoModal = new bootstrap.Modal(document.getElementById('photoModal'));
const modalImage = document.getElementById('modalImage');

modalTriggerElements.forEach(trigger => {
    trigger.addEventListener('click', () => {
        modalImage.src = trigger.src;
        modalImage.alt = trigger.alt;
        photoModal.show();
    });
});
document.getElementById('editSolutionsBtn').addEventListener('click', function () {
    const editModal = new bootstrap.Modal(document.getElementById('editSolutionsModal'));
    editModal.show();
});
</script>

{% endblock %}